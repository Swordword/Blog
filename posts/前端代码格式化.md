---
title: 前端代码格式化
date: 2021-05-17 18:13:02
category: category
tag: JavaScript,规范
cover: 
description: 使用 husky+lint-staged 配合 eslint 规范编码风格
---

### 前言

虽然现在公司的前端只有我一个，但是前端项目该做的代码统一风格还是要做的 🐔。本文尝试 使用husky+lint-staged在每次 `git commit` 时执行 `eslint --fix`格式化代码。

### 使用教程

#### husky 

在你每次敲出`git commit`之后，你是不是常常会感到后悔？为了准时下班，涂涂改改的代码不加修饰就提到了公司git仓库上面，甚至包含一些冗余、错误(!)的代码。还好我现在只有一个人，拉的屎没人看得见，不然不得被同事打死。。。husky(哈士奇)，就像清理粪便的威猛先生，即使专门来解决这个问题的。它会在你`commit`之前，格式化你的代码呀，跑跑你写的单元测试呀，生成说明文档呀等等之类的。是将你的代码资产送至公有(公司拥有)前的最后一道锁。

##### 安装

`husky` 大概在 v4.0之后的安装和使用与之前有了天翻地覆的变化，之前只是使用过v1.x的版本，新的版本直接让我眼前一愣。。。

`husky`提供了一个`husky-init`的命令行工具帮助项目安装`husky`,

```bash
npx husky-init && npm install       # npm
npx husky-init && yarn              # Yarn 1
yarn dlx husky-init --yarn2 && yarn # Yarn 2
```

该`bash`会在当前项目安装`husky`,编辑`package.json`并且创建一个`.husky`文件夹，里面预置一个`pre-commit`钩子, 这个钩子会在 每次commit之前跑一遍`npx test`。我们需要改一下这个命令

```bash
# .husky/pre-commit
#!/bin/sh
. "$(dirname "$0")/_/husky.sh"
# npm test
npx --no-install lint-staged
```

即运行`lint-staged` ，这个东东是之后要使用的，在介绍它之前，先来大致介绍一下`eslint`

#### Eslint

eslint是一个工具，两个用途：代码格式化、检测代码常见语法错误。

##### 安装

```bash
npm install eslint --save-dev		# npm
yarn add eslint --save-dev			# yarn
```

执行`npx eslint --init`，会问你几个问题，按照实际项目的需求回答就可以，会生成一个`eslint`的配置文件。

![image-20210518001736137](/Users/swordword/Library/Application Support/typora-user-images/image-20210518001736137.png)

执行 `npx eslint --fix src` 会检查src文件夹下的文件是不是有不符合规范的代码



[未完待续...]

