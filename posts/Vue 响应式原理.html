<!DOCTYPE html><html lang="zh-Hans"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><link rel="icon" href="/favicon.ico"/><meta name="description" content="Learn how to build a personal website using Next.js"/><meta property="og:image" content="https://og-image.now.sh/Swordword&#x27;s%20blog.png?theme=light&amp;md=0&amp;fontSize=75px&amp;images=https%3A%2F%2Fassets.vercel.com%2Fimage%2Fupload%2Ffront%2Fassets%2Fdesign%2Fnextjs-black-logo.svg"/><meta name="og:title" content="Swordword&#x27;s blog"/><title>Vue 响应式原理</title><meta name="next-head-count" content="7"/><link rel="preload" href="/_next/static/css/876d048b5dab7c28.css" as="style"/><link rel="stylesheet" href="/_next/static/css/876d048b5dab7c28.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-d0adf646434a14b2.js" defer=""></script><script src="/_next/static/chunks/framework-2c79e2a64abdb08b.js" defer=""></script><script src="/_next/static/chunks/main-7c48f75ce2db1491.js" defer=""></script><script src="/_next/static/chunks/pages/_app-e272e05dd28ef959.js" defer=""></script><script src="/_next/static/chunks/130-b952c5d507d712ac.js" defer=""></script><script src="/_next/static/chunks/749-555cb8054e68346e.js" defer=""></script><script src="/_next/static/chunks/241-e8e3e8578555aa77.js" defer=""></script><script src="/_next/static/chunks/783-464c81cbfd42177e.js" defer=""></script><script src="/_next/static/chunks/pages/posts/%5Bid%5D-4108770bd2d21ccc.js" defer=""></script><script src="/_next/static/N-OKAoxaKmOR4Qwc77KAc/_buildManifest.js" defer=""></script><script src="/_next/static/N-OKAoxaKmOR4Qwc77KAc/_ssgManifest.js" defer=""></script></head><body><div id="__next"><style data-emotion="css dbbey5">.css-dbbey5{width:100vw;height:100vh;overflow-y:scroll;background:#eee;color:#3c4858;padding-bottom:50px;}</style><div class="css-dbbey5"><style data-emotion="css gpj3uu">.css-gpj3uu{width:100%;height:50px;color:#fff;background-color:rgba(47,65,84,0.7);box-shadow:0 2px 5px 0 rgb(0 0 0 / 16%),0 2px 10px 0 rgb(0 0 0 / 12%);position:fixed;top:0;left:0;z-index:2;}</style><div class="css-gpj3uu"><style data-emotion="css qjodyr">.css-qjodyr{width:1100px;height:100%;margin:auto;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}</style><div class="css-qjodyr"><a href="/"><style data-emotion="css 19m5m0c">.css-19m5m0c{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:start;-ms-flex-pack:start;-webkit-justify-content:flex-start;justify-content:flex-start;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;cursor:pointer;}</style><div class="css-19m5m0c"><style data-emotion="css l2tq7e">.css-l2tq7e{width:30px;height:30px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}</style><div class="css-l2tq7e"><style data-emotion="css brme6v">.css-brme6v{width:24px;height:24px;margin-left:6px;}</style><svg class="icon css-brme6v" aria-hidden="true"><use xlink:href="#icon-sword"></use></svg></div><style data-emotion="css 879ic9">.css-879ic9{margin-left:20px;}</style><div class="css-879ic9">Swordword</div></div></a><style data-emotion="css fhxb3m">.css-fhxb3m{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}</style><div class="css-fhxb3m"><a href="/"><style data-emotion="css kfc5ms">.css-kfc5ms{width:100px;height:50px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;cursor:pointer;}.css-kfc5ms:hover{color:#30A9DE;background-color:rgba(0,0,0,0.1);}</style><div class="css-kfc5ms"><div class="css-l2tq7e"><svg class="icon css-brme6v" aria-hidden="true"><use xlink:href="#icon-home"></use></svg></div><style data-emotion="css 1a2afmv">.css-1a2afmv{margin-left:10px;}</style><div class="css-1a2afmv">首页</div></div></a><style data-emotion="css 1lwiia1">.css-1lwiia1{width:100px;height:50px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;cursor:pointer;position:relative;}.css-1lwiia1:hover .nav-list{display:block;}</style><div class="css-1lwiia1"><div class="css-l2tq7e"><svg class="icon css-brme6v" aria-hidden="true"><use xlink:href="#icon-list"></use></svg></div><div class="css-1a2afmv">索引</div><style data-emotion="css su4vv2">.css-su4vv2{-webkit-transition:3s ease-out;transition:3s ease-out;display:none;width:100px;position:absolute;top:50px;left:0;background-color:rgba(47,65,84,0.7);box-shadow:0 2px 5px 0 rgb(0 0 0 / 16%),0 2px 10px 0 rgb(0 0 0 / 12%);}</style><div class="nav-list css-su4vv2"><a href="/archive"><div class="css-kfc5ms"><div class="css-l2tq7e"><svg class="icon css-brme6v" aria-hidden="true"><use xlink:href="#icon-guidang"></use></svg></div><div class="css-1a2afmv">归档</div></div></a><a href="/category"><div class="css-kfc5ms"><div class="css-l2tq7e"><svg class="icon css-brme6v" aria-hidden="true"><use xlink:href="#icon-leimupinleifenleileibie2"></use></svg></div><div class="css-1a2afmv">分类</div></div></a><a href="/tag"><div class="css-kfc5ms"><div class="css-l2tq7e"><svg class="icon css-brme6v" aria-hidden="true"><use xlink:href="#icon-tag1"></use></svg></div><div class="css-1a2afmv">标签</div></div></a></div></div><a href="/about"><div class="css-kfc5ms"><div class="css-l2tq7e"><svg class="icon css-brme6v" aria-hidden="true"><use xlink:href="#icon-lianhe4"></use></svg></div><div class="css-1a2afmv">关于</div></div></a><a href="/rss"><div class="css-kfc5ms"><div class="css-l2tq7e"><svg class="icon css-brme6v" aria-hidden="true"><use xlink:href="#icon-rss"></use></svg></div><div class="css-1a2afmv">RSS</div></div></a><div class="css-l2tq7e"><svg class="icon css-brme6v" aria-hidden="true"><use xlink:href="#icon-OOjs_UI_icon_search-ltr"></use></svg></div><div class="css-1a2afmv"><div class="css-l2tq7e"><svg class="icon css-brme6v" aria-hidden="true"><use xlink:href="#icon-sun"></use></svg></div></div></div></div></div><style data-emotion="css 1739oy8">.css-1739oy8{z-index:1;}</style><div class="css-1739oy8"><style data-emotion="css z6d19t">.css-z6d19t{width:100%;height:350px;position:relative;background:url(/_next/static/media/banner.eb35a883.jpg) center;}</style><div class="css-z6d19t"></div></div><style data-emotion="css 3vwp2t">.css-3vwp2t{position:relative;width:1100px;background:#fff;padding:50px 100px;margin:-150px auto 50px;border-radius:8px;}</style><main class="css-3vwp2t"><article style="color:#3c4858"><style data-emotion="css yrjjfw">.css-yrjjfw{height:70px;margin:0;line-height:70px;text-align:center;font-size:40px;}</style><h1 class="css-yrjjfw">Vue 响应式原理</h1><style data-emotion="css faxeo3">.css-faxeo3{margin-left:250px;}</style><div class="css-faxeo3"><style data-emotion="css hc4w4d">.css-hc4w4d{height:40px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:start;-ms-flex-pack:start;-webkit-justify-content:flex-start;justify-content:flex-start;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}</style><div class="css-hc4w4d"><style data-emotion="css 12qt3ml">.css-12qt3ml{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:start;-ms-flex-pack:start;-webkit-justify-content:flex-start;justify-content:flex-start;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}</style><div class="css-12qt3ml"><style data-emotion="css 2ldgmb">.css-2ldgmb{color:#30a9de;}</style><small class="css-2ldgmb"><div class="css-l2tq7e"><svg class="icon css-brme6v" aria-hidden="true"><use xlink:href="#icon-time"></use></svg></div></small><style data-emotion="css qq1p72">.css-qq1p72{margin-left:10px;margin-right:20px;cursor:pointer;}</style><small class="css-qq1p72"><a href="/archive"><span><time dateTime="2019-06-29T13:45:05.000Z">19-06-29</time></span></a></small></div><div class="css-12qt3ml"><small class="css-2ldgmb"><div class="css-l2tq7e"><svg class="icon css-brme6v" aria-hidden="true"><use xlink:href="#icon-leimupinleifenleileibie2"></use></svg></div></small><small class="css-qq1p72"><a href="/category"><span>前往分类</span></a></small></div><div class="css-12qt3ml"><small class="css-2ldgmb"><div class="css-l2tq7e"><svg class="icon css-brme6v" aria-hidden="true"><use xlink:href="#icon-tag1"></use></svg></div></small><small class="css-qq1p72"><a href="/tag/javascript"><span>JavaScript<!-- --> </span></a><a href="/tag/vue"><span>Vue<!-- --> </span></a><a href="/tag/reactive"><span>Reactive<!-- --> </span></a></small></div></div></div><style data-emotion="css h25mx1">.css-h25mx1{border-bottom:1px solid #30a9de;margin-top:20px;margin-bottom:20px;}</style><div class="css-h25mx1"></div><div><h2 id="user-content-背景"><a href="#%E8%83%8C%E6%99%AF" aria-hidden="true" tabindex="-1"><span></span></a>背景</h2>
<p>vue的响应式更新是vue的一大特点</p>
<p>响应式原理一般包括以下几个部分</p>
<ul>
<li>通过数据劫持/数据代理：用于侦测数据的变化</li>
<li>依赖收集：收集视图用来了哪些数据</li>
<li>发布订阅模式：当数据发生变化时，自动通知需要更新的视图，进行更新</li>
</ul>
<h2 id="user-content-准备"><a href="#%E5%87%86%E5%A4%87" aria-hidden="true" tabindex="-1"><span></span></a>准备</h2>
<pre><code><span>class</span> <span>Vue</span> {
  <span>constructor</span>(<span>options</span>) {
    <span>let</span> data = (<span>this</span>.<span>_data</span> = options.<span>data</span>)
    <span>observe</span>(data)
	}
}
<span>let</span> vue = <span>new</span> <span>Vue</span>({
  <span>data</span>: {
    <span>name</span>: <span>'Bob'</span>,
  },
})
<span>setTimeout</span>(<span>() =></span> {
  vue.<span>_data</span>.<span>name</span> = <span>'Alice'</span>
}, <span>1000</span>)</code></pre>
<h2 id="user-content-数据劫持"><a href="#%E6%95%B0%E6%8D%AE%E5%8A%AB%E6%8C%81" aria-hidden="true" tabindex="-1"><span></span></a>数据劫持</h2>
<p>vue2.x的数据劫持使用的是<code>Object.defineProperty</code>,其不能对数组和特殊对象进行监听，因此Vue3.x使用的<code>Proxy</code>则解决了这个问题</p>
<pre><code><span>function</span> <span>observe</span>(<span>obj</span>){
  <span>if</span>(!obj|| <span>typeof</span> obj ===<span>'object'</span>) <span>return</span>
  <span>Object</span>.<span>keys</span>(obj).<span>forEach</span>(<span><span>key</span>=></span>{
    <span>// 劫持obj的每个属性</span>
    <span>defineReactive</span>(obj,key,obj[key])
  })
}
<span>function</span> <span>defineReactive</span>(<span>obj,key,val</span>){
  <span>// 如果 val 是一个对象，则需要深度遍历该对象</span>
  <span>observe</span>(val)  
  <span>Object</span>.<span>defineProperty</span>(obj,key,{
    <span>configureble</span>: <span>true</span>,	<span>// 可删除</span>
    <span>enumrable</span>: <span>true</span>,	<span>// 可遍历</span>
    <span>get</span>(<span></span>){
      <span>return</span> val;
    },
    <span>set</span>(<span>newVal</span>){
      <span>if</span> (val === newVal) <span>return</span>
      val = newVal
      <span>// 如果设置的是一个新的对象，也需要劫持这个对象</span>
      <span>observe</span>(newVal)
    }
	})
}</code></pre>
<h3 id="user-content-vue3x使用的proxy有何优势"><a href="#vue3x%E4%BD%BF%E7%94%A8%E7%9A%84proxy%E6%9C%89%E4%BD%95%E4%BC%98%E5%8A%BF" aria-hidden="true" tabindex="-1"><span></span></a>Vue3.x使用的Proxy有何优势</h3>
<ul>
<li>
<p>proxy对于数组的变化也能监听到</p>
</li>
<li>
<p>不需要想defineProperty进行深度遍历监听</p>
</li>
</ul>
<pre><code><span>class</span> <span>Vue</span> {
  <span>constructor</span>(<span>options</span>) {
    <span>this</span>.<span>_data</span> = options.<span>data</span>
    <span>this</span>.<span>_data</span> = <span>observe</span>(options.<span>data</span>)
  }
}
<span>function</span> <span>observe</span>(<span>obj</span>) {
  <span>let</span> dep = <span>new</span> <span>Dep</span>()
  <span>return</span> <span>new</span> <span>Proxy</span>(obj, {
    <span>get</span>(<span>obj, prop</span>) {
      <span>return</span> obj[prop]
    },
    <span>set</span>(<span>obj, props, newVal</span>) {
      <span>if</span> (obj[props] === newVal) <span>return</span>
      obj[props] = newVal
    },
  })
}</code></pre>
<h2 id="user-content-依赖收集"><a href="#%E4%BE%9D%E8%B5%96%E6%94%B6%E9%9B%86" aria-hidden="true" tabindex="-1"><span></span></a>依赖收集</h2>
<p>依赖收集是一个队列，如果视图使用了监听的data，则创建一个新的 Wactcher，将其 push 到依赖收集的队列中</p>
<pre><code><span>class</span> <span>Dep</span> {
  <span>static</span> target = <span>null</span>
  subs = []
  <span>addSub</span>(<span>sub</span>) {
    <span>// sub 是一个 Wacther 实例</span>
    <span>this</span>.<span>subs</span>.<span>push</span>(sub)
  }
  <span>notify</span>(<span></span>) {
    <span>this</span>.<span>subs</span>.<span>forEach</span>(<span>(<span>watcher</span>) =></span> watcher.<span>update</span>())
  }
}</code></pre>
<h2 id="user-content-发布订阅"><a href="#%E5%8F%91%E5%B8%83%E8%AE%A2%E9%98%85" aria-hidden="true" tabindex="-1"><span></span></a>发布订阅</h2>
<p>发布订阅其实内部储存了一个用于更新视图的 callback 函数，放在依赖收集的队列中，当 data 的属性发生变化时，依赖收集队列中的每个 wacther都会调用 update 函数，从而触发视图更新</p>
<pre><code><span>class</span> <span>Wacther</span>{
  <span>// vm 时 Vue 的实例</span>
  <span>constructor</span>(<span>vm,exp,cb</span>){
    <span>Dep</span>.<span>target</span> = <span>this</span>
    <span>this</span>.<span>vm</span> = vm
    <span>this</span>.<span>exp</span> = exp
    <span>this</span>.<span>cb</span> = cb
    <span>// vm._data.a，从而触发 data.get 方法，在 dep 中 push 这个 Dep.target（即这个watcher）</span>
    <span>let</span> arr = exp.<span>split</span>(<span>'.'</span>)
    <span>let</span> val = vm
    arr.<span>forEach</span>(<span><span>key</span>=></span>{
      val = val[key]
    })
    <span>Dep</span>.<span>target</span> = <span>null</span>
  }
}</code></pre>
<h2 id="user-content-更新-数据劫持的函数"><a href="#%E6%9B%B4%E6%96%B0-%E6%95%B0%E6%8D%AE%E5%8A%AB%E6%8C%81%E7%9A%84%E5%87%BD%E6%95%B0" aria-hidden="true" tabindex="-1"><span></span></a>更新 数据劫持的函数</h2>
<p>现在有了依赖收集的队列和生成发布订阅的构造函数，我们需要更新一下 observe 函数来使用这个 dep 队列和 wacther 实例</p>
<pre><code>...
<span>function</span> <span>defineReactive</span>(<span>obj,key,val</span>){
  <span>// 如果 val 是一个对象，则需要深度遍历该对象</span>
  <span>observe</span>(val)  
+  <span>// 实例化一个依赖收集队列，里面存放的订阅实例 Watcher</span>
+  <span>let</span> dep = <span>new</span> <span>Dep</span>()
  <span>Object</span>.<span>defineProperty</span>(obj, key,{
    <span>configureble</span>: <span>true</span>,	<span>// 可删除</span>
    <span>enumrable</span>: <span>true</span>,	<span>// 可遍历</span>
    <span>get</span>(<span></span>){
+     <span>// Dep.target 是 Wacther，见之后的 Wactcher 的构造函数</span>
+      <span>Dep</span>.<span>target</span> &#x26;&#x26; dep.<span>addSub</span>(<span>Dep</span>.<span>target</span>)
      <span>return</span> val;
    },
    <span>set</span>(<span>newVal</span>){
      <span>if</span> (val === newVal) <span>return</span>
      val = newVal
      <span>// 如果设置的是一个新的对象，也需要劫持这个对象</span>
      <span>observe</span>(newVal)
+      <span>// 当设置新值时,触发 Wacther 中 update 函数，对视图进行更新</span>
+      dep.<span>notify</span>()
    }
	})
}</code></pre>
<p>使用 proxy与法 与上述相同</p>
<h2 id="user-content-总结"><a href="#%E6%80%BB%E7%BB%93" aria-hidden="true" tabindex="-1"><span></span></a>总结</h2>
<p>完整的实例如下</p>
<pre><code><span>class</span> <span>Vue</span> {
  <span>constructor</span>(<span>options</span>) {
    <span>let</span> data = (<span>this</span>.<span>_data</span> = options.<span>data</span>)
    <span>observe</span>(data)
  }
}

<span>function</span> <span>observe</span>(<span>obj</span>) {
  <span>if</span> (!obj || <span>typeof</span> obj !== <span>'object'</span>) <span>return</span>
  <span>Object</span>.<span>keys</span>(obj).<span>forEach</span>(<span>(<span>key</span>) =></span> <span>defineReactive</span>(obj, key, obj[key]))
  <span>function</span> <span>defineReactive</span>(<span>obj, key, val</span>) {
    <span>observe</span>(val)
    <span>let</span> dep = <span>new</span> <span>Dep</span>()
    <span>Object</span>.<span>defineProperty</span>(obj, key, {
      <span>configurable</span>: <span>true</span>,
      <span>enumerable</span>: <span>true</span>,
      <span>get</span>(<span></span>) {
        <span>Dep</span>.<span>target</span> &#x26;&#x26; dep.<span>addSub</span>(<span>Dep</span>.<span>target</span>)
        <span>return</span> val
      },
      <span>set</span>(<span>newVal</span>) {
        <span>if</span> (val === newVal) <span>return</span>
        val = newVal
        dep.<span>notify</span>()
        <span>observe</span>(newVal)
      },
    })
  }
}

<span>class</span> <span>Dep</span> {
  <span>static</span> target = <span>null</span>
  subs = []
  <span>addSub</span>(<span>sub</span>) {
    <span>this</span>.<span>subs</span>.<span>push</span>(sub)
  }
  <span>notify</span>(<span></span>) {
    <span>this</span>.<span>subs</span>.<span>forEach</span>(<span>(<span>sub</span>) =></span> sub.<span>update</span>())
  }
}

<span>class</span> <span>Watcher</span> {
  <span>constructor</span>(<span>vm, exp, cb</span>) {
    <span>this</span>.<span>vm</span> = vm
    <span>this</span>.<span>exp</span> = exp
    <span>this</span>.<span>cb</span> = cb
    <span>Dep</span>.<span>target</span> = <span>this</span>
    <span>let</span> val = vm.<span>_data</span>
    exp.<span>split</span>(<span>'.'</span>).<span>forEach</span>(<span>(<span>key</span>) =></span> {
      val = val[key]
    })
    <span>Dep</span>.<span>target</span> = <span>null</span>
  }
  <span>update</span>(<span></span>) {
    <span>let</span> val = <span>this</span>.<span>vm</span>.<span>_data</span>
    <span>this</span>.<span>exp</span>.<span>split</span>(<span>'.'</span>).<span>forEach</span>(<span>(<span>key</span>) =></span> {
      val = val[key]
    })
    <span>this</span>.<span>cb</span>(val)
  }
}

<span>let</span> vue = <span>new</span> <span>Vue</span>({
  <span>data</span>: {
    <span>name</span>: <span>'Bob'</span>,
  },
})

<span>// 手动添加一个 watcher，实际情况下，模版渲染时自动生成订阅函数</span>
<span>new</span> <span>Watcher</span>(vue, <span>'name'</span>, <span>(<span>newVal</span>) =></span> {
  <span>console</span>.<span>log</span>(<span>'render'</span>, newVal)
})

<span>setTimeout</span>(<span>() =></span> {
  vue.<span>_data</span>.<span>name</span> = <span>'Alice'</span>
}, <span>1000</span>)</code></pre>
<h2 id="user-content-参考"><a href="#%E5%8F%82%E8%80%83" aria-hidden="true" tabindex="-1"><span></span></a>参考</h2>
<p><a href="https://cn.vuejs.org/v2/guide/reactivity.html">深入响应式原理 — Vue.js (vuejs.org)</a></p>
<p><a href="https://juejin.cn/post/6844903586103558158">不好意思！耽误你的十分钟，让MVVM原理还给你 (juejin.cn)</a></p>
<p><a href="https://juejin.cn/book/6844733705089449991/section/6844733705228025869">剖析 Vue.js 内部运行机制 - 染陌同学 - 掘金小册 (juejin.cn)</a></p>
<p><a href="https://ustbhuangyi.github.io/vue-analysis/v2/reactive/reactive-object.html">响应式对象 | Vue.js 技术揭秘 (ustbhuangyi.github.io)</a></p>
<p><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Proxy">Proxy - JavaScript | MDN (mozilla.org)</a></p>
</div></article></main></div><style data-emotion="css 1st94pw">.css-1st94pw{text-align:center;height:30px;line-height:30px;color:#333;}</style><div class="css-1st94pw"><a href="https://beian.miit.gov.cn/" target="_blank" rel="noreferrer">京ICP备19054504号-2</a></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"postData":{"id":"Vue 响应式原理","contentHtml":"\u003ch2 id=\"user-content-背景\"\u003e\u003ca href=\"#%E8%83%8C%E6%99%AF\" aria-hidden=\"true\" tabindex=\"-1\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/a\u003e背景\u003c/h2\u003e\n\u003cp\u003evue的响应式更新是vue的一大特点\u003c/p\u003e\n\u003cp\u003e响应式原理一般包括以下几个部分\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e通过数据劫持/数据代理：用于侦测数据的变化\u003c/li\u003e\n\u003cli\u003e依赖收集：收集视图用来了哪些数据\u003c/li\u003e\n\u003cli\u003e发布订阅模式：当数据发生变化时，自动通知需要更新的视图，进行更新\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"user-content-准备\"\u003e\u003ca href=\"#%E5%87%86%E5%A4%87\" aria-hidden=\"true\" tabindex=\"-1\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/a\u003e准备\u003c/h2\u003e\n\u003cpre\u003e\u003ccode\u003e\u003cspan\u003eclass\u003c/span\u003e \u003cspan\u003eVue\u003c/span\u003e {\n  \u003cspan\u003econstructor\u003c/span\u003e(\u003cspan\u003eoptions\u003c/span\u003e) {\n    \u003cspan\u003elet\u003c/span\u003e data = (\u003cspan\u003ethis\u003c/span\u003e.\u003cspan\u003e_data\u003c/span\u003e = options.\u003cspan\u003edata\u003c/span\u003e)\n    \u003cspan\u003eobserve\u003c/span\u003e(data)\n\t}\n}\n\u003cspan\u003elet\u003c/span\u003e vue = \u003cspan\u003enew\u003c/span\u003e \u003cspan\u003eVue\u003c/span\u003e({\n  \u003cspan\u003edata\u003c/span\u003e: {\n    \u003cspan\u003ename\u003c/span\u003e: \u003cspan\u003e'Bob'\u003c/span\u003e,\n  },\n})\n\u003cspan\u003esetTimeout\u003c/span\u003e(\u003cspan\u003e() =\u003e\u003c/span\u003e {\n  vue.\u003cspan\u003e_data\u003c/span\u003e.\u003cspan\u003ename\u003c/span\u003e = \u003cspan\u003e'Alice'\u003c/span\u003e\n}, \u003cspan\u003e1000\u003c/span\u003e)\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"user-content-数据劫持\"\u003e\u003ca href=\"#%E6%95%B0%E6%8D%AE%E5%8A%AB%E6%8C%81\" aria-hidden=\"true\" tabindex=\"-1\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/a\u003e数据劫持\u003c/h2\u003e\n\u003cp\u003evue2.x的数据劫持使用的是\u003ccode\u003eObject.defineProperty\u003c/code\u003e,其不能对数组和特殊对象进行监听，因此Vue3.x使用的\u003ccode\u003eProxy\u003c/code\u003e则解决了这个问题\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e\u003cspan\u003efunction\u003c/span\u003e \u003cspan\u003eobserve\u003c/span\u003e(\u003cspan\u003eobj\u003c/span\u003e){\n  \u003cspan\u003eif\u003c/span\u003e(!obj|| \u003cspan\u003etypeof\u003c/span\u003e obj ===\u003cspan\u003e'object'\u003c/span\u003e) \u003cspan\u003ereturn\u003c/span\u003e\n  \u003cspan\u003eObject\u003c/span\u003e.\u003cspan\u003ekeys\u003c/span\u003e(obj).\u003cspan\u003eforEach\u003c/span\u003e(\u003cspan\u003e\u003cspan\u003ekey\u003c/span\u003e=\u003e\u003c/span\u003e{\n    \u003cspan\u003e// 劫持obj的每个属性\u003c/span\u003e\n    \u003cspan\u003edefineReactive\u003c/span\u003e(obj,key,obj[key])\n  })\n}\n\u003cspan\u003efunction\u003c/span\u003e \u003cspan\u003edefineReactive\u003c/span\u003e(\u003cspan\u003eobj,key,val\u003c/span\u003e){\n  \u003cspan\u003e// 如果 val 是一个对象，则需要深度遍历该对象\u003c/span\u003e\n  \u003cspan\u003eobserve\u003c/span\u003e(val)  \n  \u003cspan\u003eObject\u003c/span\u003e.\u003cspan\u003edefineProperty\u003c/span\u003e(obj,key,{\n    \u003cspan\u003econfigureble\u003c/span\u003e: \u003cspan\u003etrue\u003c/span\u003e,\t\u003cspan\u003e// 可删除\u003c/span\u003e\n    \u003cspan\u003eenumrable\u003c/span\u003e: \u003cspan\u003etrue\u003c/span\u003e,\t\u003cspan\u003e// 可遍历\u003c/span\u003e\n    \u003cspan\u003eget\u003c/span\u003e(\u003cspan\u003e\u003c/span\u003e){\n      \u003cspan\u003ereturn\u003c/span\u003e val;\n    },\n    \u003cspan\u003eset\u003c/span\u003e(\u003cspan\u003enewVal\u003c/span\u003e){\n      \u003cspan\u003eif\u003c/span\u003e (val === newVal) \u003cspan\u003ereturn\u003c/span\u003e\n      val = newVal\n      \u003cspan\u003e// 如果设置的是一个新的对象，也需要劫持这个对象\u003c/span\u003e\n      \u003cspan\u003eobserve\u003c/span\u003e(newVal)\n    }\n\t})\n}\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"user-content-vue3x使用的proxy有何优势\"\u003e\u003ca href=\"#vue3x%E4%BD%BF%E7%94%A8%E7%9A%84proxy%E6%9C%89%E4%BD%95%E4%BC%98%E5%8A%BF\" aria-hidden=\"true\" tabindex=\"-1\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/a\u003eVue3.x使用的Proxy有何优势\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003eproxy对于数组的变化也能监听到\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e不需要想defineProperty进行深度遍历监听\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre\u003e\u003ccode\u003e\u003cspan\u003eclass\u003c/span\u003e \u003cspan\u003eVue\u003c/span\u003e {\n  \u003cspan\u003econstructor\u003c/span\u003e(\u003cspan\u003eoptions\u003c/span\u003e) {\n    \u003cspan\u003ethis\u003c/span\u003e.\u003cspan\u003e_data\u003c/span\u003e = options.\u003cspan\u003edata\u003c/span\u003e\n    \u003cspan\u003ethis\u003c/span\u003e.\u003cspan\u003e_data\u003c/span\u003e = \u003cspan\u003eobserve\u003c/span\u003e(options.\u003cspan\u003edata\u003c/span\u003e)\n  }\n}\n\u003cspan\u003efunction\u003c/span\u003e \u003cspan\u003eobserve\u003c/span\u003e(\u003cspan\u003eobj\u003c/span\u003e) {\n  \u003cspan\u003elet\u003c/span\u003e dep = \u003cspan\u003enew\u003c/span\u003e \u003cspan\u003eDep\u003c/span\u003e()\n  \u003cspan\u003ereturn\u003c/span\u003e \u003cspan\u003enew\u003c/span\u003e \u003cspan\u003eProxy\u003c/span\u003e(obj, {\n    \u003cspan\u003eget\u003c/span\u003e(\u003cspan\u003eobj, prop\u003c/span\u003e) {\n      \u003cspan\u003ereturn\u003c/span\u003e obj[prop]\n    },\n    \u003cspan\u003eset\u003c/span\u003e(\u003cspan\u003eobj, props, newVal\u003c/span\u003e) {\n      \u003cspan\u003eif\u003c/span\u003e (obj[props] === newVal) \u003cspan\u003ereturn\u003c/span\u003e\n      obj[props] = newVal\n    },\n  })\n}\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"user-content-依赖收集\"\u003e\u003ca href=\"#%E4%BE%9D%E8%B5%96%E6%94%B6%E9%9B%86\" aria-hidden=\"true\" tabindex=\"-1\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/a\u003e依赖收集\u003c/h2\u003e\n\u003cp\u003e依赖收集是一个队列，如果视图使用了监听的data，则创建一个新的 Wactcher，将其 push 到依赖收集的队列中\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e\u003cspan\u003eclass\u003c/span\u003e \u003cspan\u003eDep\u003c/span\u003e {\n  \u003cspan\u003estatic\u003c/span\u003e target = \u003cspan\u003enull\u003c/span\u003e\n  subs = []\n  \u003cspan\u003eaddSub\u003c/span\u003e(\u003cspan\u003esub\u003c/span\u003e) {\n    \u003cspan\u003e// sub 是一个 Wacther 实例\u003c/span\u003e\n    \u003cspan\u003ethis\u003c/span\u003e.\u003cspan\u003esubs\u003c/span\u003e.\u003cspan\u003epush\u003c/span\u003e(sub)\n  }\n  \u003cspan\u003enotify\u003c/span\u003e(\u003cspan\u003e\u003c/span\u003e) {\n    \u003cspan\u003ethis\u003c/span\u003e.\u003cspan\u003esubs\u003c/span\u003e.\u003cspan\u003eforEach\u003c/span\u003e(\u003cspan\u003e(\u003cspan\u003ewatcher\u003c/span\u003e) =\u003e\u003c/span\u003e watcher.\u003cspan\u003eupdate\u003c/span\u003e())\n  }\n}\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"user-content-发布订阅\"\u003e\u003ca href=\"#%E5%8F%91%E5%B8%83%E8%AE%A2%E9%98%85\" aria-hidden=\"true\" tabindex=\"-1\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/a\u003e发布订阅\u003c/h2\u003e\n\u003cp\u003e发布订阅其实内部储存了一个用于更新视图的 callback 函数，放在依赖收集的队列中，当 data 的属性发生变化时，依赖收集队列中的每个 wacther都会调用 update 函数，从而触发视图更新\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e\u003cspan\u003eclass\u003c/span\u003e \u003cspan\u003eWacther\u003c/span\u003e{\n  \u003cspan\u003e// vm 时 Vue 的实例\u003c/span\u003e\n  \u003cspan\u003econstructor\u003c/span\u003e(\u003cspan\u003evm,exp,cb\u003c/span\u003e){\n    \u003cspan\u003eDep\u003c/span\u003e.\u003cspan\u003etarget\u003c/span\u003e = \u003cspan\u003ethis\u003c/span\u003e\n    \u003cspan\u003ethis\u003c/span\u003e.\u003cspan\u003evm\u003c/span\u003e = vm\n    \u003cspan\u003ethis\u003c/span\u003e.\u003cspan\u003eexp\u003c/span\u003e = exp\n    \u003cspan\u003ethis\u003c/span\u003e.\u003cspan\u003ecb\u003c/span\u003e = cb\n    \u003cspan\u003e// vm._data.a，从而触发 data.get 方法，在 dep 中 push 这个 Dep.target（即这个watcher）\u003c/span\u003e\n    \u003cspan\u003elet\u003c/span\u003e arr = exp.\u003cspan\u003esplit\u003c/span\u003e(\u003cspan\u003e'.'\u003c/span\u003e)\n    \u003cspan\u003elet\u003c/span\u003e val = vm\n    arr.\u003cspan\u003eforEach\u003c/span\u003e(\u003cspan\u003e\u003cspan\u003ekey\u003c/span\u003e=\u003e\u003c/span\u003e{\n      val = val[key]\n    })\n    \u003cspan\u003eDep\u003c/span\u003e.\u003cspan\u003etarget\u003c/span\u003e = \u003cspan\u003enull\u003c/span\u003e\n  }\n}\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"user-content-更新-数据劫持的函数\"\u003e\u003ca href=\"#%E6%9B%B4%E6%96%B0-%E6%95%B0%E6%8D%AE%E5%8A%AB%E6%8C%81%E7%9A%84%E5%87%BD%E6%95%B0\" aria-hidden=\"true\" tabindex=\"-1\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/a\u003e更新 数据劫持的函数\u003c/h2\u003e\n\u003cp\u003e现在有了依赖收集的队列和生成发布订阅的构造函数，我们需要更新一下 observe 函数来使用这个 dep 队列和 wacther 实例\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e...\n\u003cspan\u003efunction\u003c/span\u003e \u003cspan\u003edefineReactive\u003c/span\u003e(\u003cspan\u003eobj,key,val\u003c/span\u003e){\n  \u003cspan\u003e// 如果 val 是一个对象，则需要深度遍历该对象\u003c/span\u003e\n  \u003cspan\u003eobserve\u003c/span\u003e(val)  \n+  \u003cspan\u003e// 实例化一个依赖收集队列，里面存放的订阅实例 Watcher\u003c/span\u003e\n+  \u003cspan\u003elet\u003c/span\u003e dep = \u003cspan\u003enew\u003c/span\u003e \u003cspan\u003eDep\u003c/span\u003e()\n  \u003cspan\u003eObject\u003c/span\u003e.\u003cspan\u003edefineProperty\u003c/span\u003e(obj, key,{\n    \u003cspan\u003econfigureble\u003c/span\u003e: \u003cspan\u003etrue\u003c/span\u003e,\t\u003cspan\u003e// 可删除\u003c/span\u003e\n    \u003cspan\u003eenumrable\u003c/span\u003e: \u003cspan\u003etrue\u003c/span\u003e,\t\u003cspan\u003e// 可遍历\u003c/span\u003e\n    \u003cspan\u003eget\u003c/span\u003e(\u003cspan\u003e\u003c/span\u003e){\n+     \u003cspan\u003e// Dep.target 是 Wacther，见之后的 Wactcher 的构造函数\u003c/span\u003e\n+      \u003cspan\u003eDep\u003c/span\u003e.\u003cspan\u003etarget\u003c/span\u003e \u0026#x26;\u0026#x26; dep.\u003cspan\u003eaddSub\u003c/span\u003e(\u003cspan\u003eDep\u003c/span\u003e.\u003cspan\u003etarget\u003c/span\u003e)\n      \u003cspan\u003ereturn\u003c/span\u003e val;\n    },\n    \u003cspan\u003eset\u003c/span\u003e(\u003cspan\u003enewVal\u003c/span\u003e){\n      \u003cspan\u003eif\u003c/span\u003e (val === newVal) \u003cspan\u003ereturn\u003c/span\u003e\n      val = newVal\n      \u003cspan\u003e// 如果设置的是一个新的对象，也需要劫持这个对象\u003c/span\u003e\n      \u003cspan\u003eobserve\u003c/span\u003e(newVal)\n+      \u003cspan\u003e// 当设置新值时,触发 Wacther 中 update 函数，对视图进行更新\u003c/span\u003e\n+      dep.\u003cspan\u003enotify\u003c/span\u003e()\n    }\n\t})\n}\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e使用 proxy与法 与上述相同\u003c/p\u003e\n\u003ch2 id=\"user-content-总结\"\u003e\u003ca href=\"#%E6%80%BB%E7%BB%93\" aria-hidden=\"true\" tabindex=\"-1\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/a\u003e总结\u003c/h2\u003e\n\u003cp\u003e完整的实例如下\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e\u003cspan\u003eclass\u003c/span\u003e \u003cspan\u003eVue\u003c/span\u003e {\n  \u003cspan\u003econstructor\u003c/span\u003e(\u003cspan\u003eoptions\u003c/span\u003e) {\n    \u003cspan\u003elet\u003c/span\u003e data = (\u003cspan\u003ethis\u003c/span\u003e.\u003cspan\u003e_data\u003c/span\u003e = options.\u003cspan\u003edata\u003c/span\u003e)\n    \u003cspan\u003eobserve\u003c/span\u003e(data)\n  }\n}\n\n\u003cspan\u003efunction\u003c/span\u003e \u003cspan\u003eobserve\u003c/span\u003e(\u003cspan\u003eobj\u003c/span\u003e) {\n  \u003cspan\u003eif\u003c/span\u003e (!obj || \u003cspan\u003etypeof\u003c/span\u003e obj !== \u003cspan\u003e'object'\u003c/span\u003e) \u003cspan\u003ereturn\u003c/span\u003e\n  \u003cspan\u003eObject\u003c/span\u003e.\u003cspan\u003ekeys\u003c/span\u003e(obj).\u003cspan\u003eforEach\u003c/span\u003e(\u003cspan\u003e(\u003cspan\u003ekey\u003c/span\u003e) =\u003e\u003c/span\u003e \u003cspan\u003edefineReactive\u003c/span\u003e(obj, key, obj[key]))\n  \u003cspan\u003efunction\u003c/span\u003e \u003cspan\u003edefineReactive\u003c/span\u003e(\u003cspan\u003eobj, key, val\u003c/span\u003e) {\n    \u003cspan\u003eobserve\u003c/span\u003e(val)\n    \u003cspan\u003elet\u003c/span\u003e dep = \u003cspan\u003enew\u003c/span\u003e \u003cspan\u003eDep\u003c/span\u003e()\n    \u003cspan\u003eObject\u003c/span\u003e.\u003cspan\u003edefineProperty\u003c/span\u003e(obj, key, {\n      \u003cspan\u003econfigurable\u003c/span\u003e: \u003cspan\u003etrue\u003c/span\u003e,\n      \u003cspan\u003eenumerable\u003c/span\u003e: \u003cspan\u003etrue\u003c/span\u003e,\n      \u003cspan\u003eget\u003c/span\u003e(\u003cspan\u003e\u003c/span\u003e) {\n        \u003cspan\u003eDep\u003c/span\u003e.\u003cspan\u003etarget\u003c/span\u003e \u0026#x26;\u0026#x26; dep.\u003cspan\u003eaddSub\u003c/span\u003e(\u003cspan\u003eDep\u003c/span\u003e.\u003cspan\u003etarget\u003c/span\u003e)\n        \u003cspan\u003ereturn\u003c/span\u003e val\n      },\n      \u003cspan\u003eset\u003c/span\u003e(\u003cspan\u003enewVal\u003c/span\u003e) {\n        \u003cspan\u003eif\u003c/span\u003e (val === newVal) \u003cspan\u003ereturn\u003c/span\u003e\n        val = newVal\n        dep.\u003cspan\u003enotify\u003c/span\u003e()\n        \u003cspan\u003eobserve\u003c/span\u003e(newVal)\n      },\n    })\n  }\n}\n\n\u003cspan\u003eclass\u003c/span\u003e \u003cspan\u003eDep\u003c/span\u003e {\n  \u003cspan\u003estatic\u003c/span\u003e target = \u003cspan\u003enull\u003c/span\u003e\n  subs = []\n  \u003cspan\u003eaddSub\u003c/span\u003e(\u003cspan\u003esub\u003c/span\u003e) {\n    \u003cspan\u003ethis\u003c/span\u003e.\u003cspan\u003esubs\u003c/span\u003e.\u003cspan\u003epush\u003c/span\u003e(sub)\n  }\n  \u003cspan\u003enotify\u003c/span\u003e(\u003cspan\u003e\u003c/span\u003e) {\n    \u003cspan\u003ethis\u003c/span\u003e.\u003cspan\u003esubs\u003c/span\u003e.\u003cspan\u003eforEach\u003c/span\u003e(\u003cspan\u003e(\u003cspan\u003esub\u003c/span\u003e) =\u003e\u003c/span\u003e sub.\u003cspan\u003eupdate\u003c/span\u003e())\n  }\n}\n\n\u003cspan\u003eclass\u003c/span\u003e \u003cspan\u003eWatcher\u003c/span\u003e {\n  \u003cspan\u003econstructor\u003c/span\u003e(\u003cspan\u003evm, exp, cb\u003c/span\u003e) {\n    \u003cspan\u003ethis\u003c/span\u003e.\u003cspan\u003evm\u003c/span\u003e = vm\n    \u003cspan\u003ethis\u003c/span\u003e.\u003cspan\u003eexp\u003c/span\u003e = exp\n    \u003cspan\u003ethis\u003c/span\u003e.\u003cspan\u003ecb\u003c/span\u003e = cb\n    \u003cspan\u003eDep\u003c/span\u003e.\u003cspan\u003etarget\u003c/span\u003e = \u003cspan\u003ethis\u003c/span\u003e\n    \u003cspan\u003elet\u003c/span\u003e val = vm.\u003cspan\u003e_data\u003c/span\u003e\n    exp.\u003cspan\u003esplit\u003c/span\u003e(\u003cspan\u003e'.'\u003c/span\u003e).\u003cspan\u003eforEach\u003c/span\u003e(\u003cspan\u003e(\u003cspan\u003ekey\u003c/span\u003e) =\u003e\u003c/span\u003e {\n      val = val[key]\n    })\n    \u003cspan\u003eDep\u003c/span\u003e.\u003cspan\u003etarget\u003c/span\u003e = \u003cspan\u003enull\u003c/span\u003e\n  }\n  \u003cspan\u003eupdate\u003c/span\u003e(\u003cspan\u003e\u003c/span\u003e) {\n    \u003cspan\u003elet\u003c/span\u003e val = \u003cspan\u003ethis\u003c/span\u003e.\u003cspan\u003evm\u003c/span\u003e.\u003cspan\u003e_data\u003c/span\u003e\n    \u003cspan\u003ethis\u003c/span\u003e.\u003cspan\u003eexp\u003c/span\u003e.\u003cspan\u003esplit\u003c/span\u003e(\u003cspan\u003e'.'\u003c/span\u003e).\u003cspan\u003eforEach\u003c/span\u003e(\u003cspan\u003e(\u003cspan\u003ekey\u003c/span\u003e) =\u003e\u003c/span\u003e {\n      val = val[key]\n    })\n    \u003cspan\u003ethis\u003c/span\u003e.\u003cspan\u003ecb\u003c/span\u003e(val)\n  }\n}\n\n\u003cspan\u003elet\u003c/span\u003e vue = \u003cspan\u003enew\u003c/span\u003e \u003cspan\u003eVue\u003c/span\u003e({\n  \u003cspan\u003edata\u003c/span\u003e: {\n    \u003cspan\u003ename\u003c/span\u003e: \u003cspan\u003e'Bob'\u003c/span\u003e,\n  },\n})\n\n\u003cspan\u003e// 手动添加一个 watcher，实际情况下，模版渲染时自动生成订阅函数\u003c/span\u003e\n\u003cspan\u003enew\u003c/span\u003e \u003cspan\u003eWatcher\u003c/span\u003e(vue, \u003cspan\u003e'name'\u003c/span\u003e, \u003cspan\u003e(\u003cspan\u003enewVal\u003c/span\u003e) =\u003e\u003c/span\u003e {\n  \u003cspan\u003econsole\u003c/span\u003e.\u003cspan\u003elog\u003c/span\u003e(\u003cspan\u003e'render'\u003c/span\u003e, newVal)\n})\n\n\u003cspan\u003esetTimeout\u003c/span\u003e(\u003cspan\u003e() =\u003e\u003c/span\u003e {\n  vue.\u003cspan\u003e_data\u003c/span\u003e.\u003cspan\u003ename\u003c/span\u003e = \u003cspan\u003e'Alice'\u003c/span\u003e\n}, \u003cspan\u003e1000\u003c/span\u003e)\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"user-content-参考\"\u003e\u003ca href=\"#%E5%8F%82%E8%80%83\" aria-hidden=\"true\" tabindex=\"-1\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/a\u003e参考\u003c/h2\u003e\n\u003cp\u003e\u003ca href=\"https://cn.vuejs.org/v2/guide/reactivity.html\"\u003e深入响应式原理 — Vue.js (vuejs.org)\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://juejin.cn/post/6844903586103558158\"\u003e不好意思！耽误你的十分钟，让MVVM原理还给你 (juejin.cn)\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://juejin.cn/book/6844733705089449991/section/6844733705228025869\"\u003e剖析 Vue.js 内部运行机制 - 染陌同学 - 掘金小册 (juejin.cn)\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://ustbhuangyi.github.io/vue-analysis/v2/reactive/reactive-object.html\"\u003e响应式对象 | Vue.js 技术揭秘 (ustbhuangyi.github.io)\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Proxy\"\u003eProxy - JavaScript | MDN (mozilla.org)\u003c/a\u003e\u003c/p\u003e\n","title":"Vue 响应式原理","date":"2019-06-29T13:45:05.000Z","description":"vue2.x的监听绑定使用的是`Object.defineProperty`,不能对数组和特殊对象进行监听，而`Proxy`则解决了这个问题","tag":"JavaScript,Vue,Reactive"}},"__N_SSG":true},"page":"/posts/[id]","query":{"id":"Vue 响应式原理"},"buildId":"N-OKAoxaKmOR4Qwc77KAc","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>