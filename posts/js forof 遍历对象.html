<!DOCTYPE html><html lang="zh-Hans"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><link rel="icon" href="/favicon.ico"/><meta name="description" content="Learn how to build a personal website using Next.js"/><meta property="og:image" content="https://og-image.now.sh/Swordword&#x27;s%20blog.png?theme=light&amp;md=0&amp;fontSize=75px&amp;images=https%3A%2F%2Fassets.vercel.com%2Fimage%2Fupload%2Ffront%2Fassets%2Fdesign%2Fnextjs-black-logo.svg"/><meta name="og:title" content="Swordword&#x27;s blog"/><title>JS forof 遍历数组的原理</title><meta name="next-head-count" content="7"/><link rel="preload" href="/_next/static/css/876d048b5dab7c28.css" as="style"/><link rel="stylesheet" href="/_next/static/css/876d048b5dab7c28.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-a03f34702f60fafc.js" defer=""></script><script src="/_next/static/chunks/framework-2c79e2a64abdb08b.js" defer=""></script><script src="/_next/static/chunks/main-7c48f75ce2db1491.js" defer=""></script><script src="/_next/static/chunks/pages/_app-e272e05dd28ef959.js" defer=""></script><script src="/_next/static/chunks/130-b952c5d507d712ac.js" defer=""></script><script src="/_next/static/chunks/749-555cb8054e68346e.js" defer=""></script><script src="/_next/static/chunks/241-e8e3e8578555aa77.js" defer=""></script><script src="/_next/static/chunks/783-464c81cbfd42177e.js" defer=""></script><script src="/_next/static/chunks/pages/posts/%5Bid%5D-4108770bd2d21ccc.js" defer=""></script><script src="/_next/static/yk5Zpotj4p9R4XPv5qhw8/_buildManifest.js" defer=""></script><script src="/_next/static/yk5Zpotj4p9R4XPv5qhw8/_ssgManifest.js" defer=""></script></head><body><div id="__next"><style data-emotion="css dbbey5">.css-dbbey5{width:100vw;height:100vh;overflow-y:scroll;background:#eee;color:#3c4858;padding-bottom:50px;}</style><div class="css-dbbey5"><style data-emotion="css gpj3uu">.css-gpj3uu{width:100%;height:50px;color:#fff;background-color:rgba(47,65,84,0.7);box-shadow:0 2px 5px 0 rgb(0 0 0 / 16%),0 2px 10px 0 rgb(0 0 0 / 12%);position:fixed;top:0;left:0;z-index:2;}</style><div class="css-gpj3uu"><style data-emotion="css qjodyr">.css-qjodyr{width:1100px;height:100%;margin:auto;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}</style><div class="css-qjodyr"><a href="/"><style data-emotion="css 19m5m0c">.css-19m5m0c{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:start;-ms-flex-pack:start;-webkit-justify-content:flex-start;justify-content:flex-start;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;cursor:pointer;}</style><div class="css-19m5m0c"><style data-emotion="css l2tq7e">.css-l2tq7e{width:30px;height:30px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}</style><div class="css-l2tq7e"><style data-emotion="css brme6v">.css-brme6v{width:24px;height:24px;margin-left:6px;}</style><svg class="icon css-brme6v" aria-hidden="true"><use xlink:href="#icon-sword"></use></svg></div><style data-emotion="css 879ic9">.css-879ic9{margin-left:20px;}</style><div class="css-879ic9">Swordword</div></div></a><style data-emotion="css fhxb3m">.css-fhxb3m{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}</style><div class="css-fhxb3m"><a href="/"><style data-emotion="css kfc5ms">.css-kfc5ms{width:100px;height:50px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;cursor:pointer;}.css-kfc5ms:hover{color:#30A9DE;background-color:rgba(0,0,0,0.1);}</style><div class="css-kfc5ms"><div class="css-l2tq7e"><svg class="icon css-brme6v" aria-hidden="true"><use xlink:href="#icon-home"></use></svg></div><style data-emotion="css 1a2afmv">.css-1a2afmv{margin-left:10px;}</style><div class="css-1a2afmv">首页</div></div></a><style data-emotion="css 1lwiia1">.css-1lwiia1{width:100px;height:50px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;cursor:pointer;position:relative;}.css-1lwiia1:hover .nav-list{display:block;}</style><div class="css-1lwiia1"><div class="css-l2tq7e"><svg class="icon css-brme6v" aria-hidden="true"><use xlink:href="#icon-list"></use></svg></div><div class="css-1a2afmv">索引</div><style data-emotion="css su4vv2">.css-su4vv2{-webkit-transition:3s ease-out;transition:3s ease-out;display:none;width:100px;position:absolute;top:50px;left:0;background-color:rgba(47,65,84,0.7);box-shadow:0 2px 5px 0 rgb(0 0 0 / 16%),0 2px 10px 0 rgb(0 0 0 / 12%);}</style><div class="nav-list css-su4vv2"><a href="/archive"><div class="css-kfc5ms"><div class="css-l2tq7e"><svg class="icon css-brme6v" aria-hidden="true"><use xlink:href="#icon-guidang"></use></svg></div><div class="css-1a2afmv">归档</div></div></a><a href="/category"><div class="css-kfc5ms"><div class="css-l2tq7e"><svg class="icon css-brme6v" aria-hidden="true"><use xlink:href="#icon-leimupinleifenleileibie2"></use></svg></div><div class="css-1a2afmv">分类</div></div></a><a href="/tag"><div class="css-kfc5ms"><div class="css-l2tq7e"><svg class="icon css-brme6v" aria-hidden="true"><use xlink:href="#icon-tag1"></use></svg></div><div class="css-1a2afmv">标签</div></div></a></div></div><a href="/about"><div class="css-kfc5ms"><div class="css-l2tq7e"><svg class="icon css-brme6v" aria-hidden="true"><use xlink:href="#icon-lianhe4"></use></svg></div><div class="css-1a2afmv">关于</div></div></a><a href="/rss"><div class="css-kfc5ms"><div class="css-l2tq7e"><svg class="icon css-brme6v" aria-hidden="true"><use xlink:href="#icon-rss"></use></svg></div><div class="css-1a2afmv">RSS</div></div></a><div class="css-l2tq7e"><svg class="icon css-brme6v" aria-hidden="true"><use xlink:href="#icon-OOjs_UI_icon_search-ltr"></use></svg></div><div class="css-1a2afmv"><div class="css-l2tq7e"><svg class="icon css-brme6v" aria-hidden="true"><use xlink:href="#icon-sun"></use></svg></div></div></div></div></div><style data-emotion="css 1739oy8">.css-1739oy8{z-index:1;}</style><div class="css-1739oy8"><style data-emotion="css z6d19t">.css-z6d19t{width:100%;height:350px;position:relative;background:url(/_next/static/media/banner.eb35a883.jpg) center;}</style><div class="css-z6d19t"></div></div><style data-emotion="css 3vwp2t">.css-3vwp2t{position:relative;width:1100px;background:#fff;padding:50px 100px;margin:-150px auto 50px;border-radius:8px;}</style><main class="css-3vwp2t"><article style="color:#3c4858"><style data-emotion="css yrjjfw">.css-yrjjfw{height:70px;margin:0;line-height:70px;text-align:center;font-size:40px;}</style><h1 class="css-yrjjfw">JS forof 遍历数组的原理</h1><style data-emotion="css faxeo3">.css-faxeo3{margin-left:250px;}</style><div class="css-faxeo3"><style data-emotion="css hc4w4d">.css-hc4w4d{height:40px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:start;-ms-flex-pack:start;-webkit-justify-content:flex-start;justify-content:flex-start;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}</style><div class="css-hc4w4d"><style data-emotion="css 12qt3ml">.css-12qt3ml{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:start;-ms-flex-pack:start;-webkit-justify-content:flex-start;justify-content:flex-start;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}</style><div class="css-12qt3ml"><style data-emotion="css 2ldgmb">.css-2ldgmb{color:#30a9de;}</style><small class="css-2ldgmb"><div class="css-l2tq7e"><svg class="icon css-brme6v" aria-hidden="true"><use xlink:href="#icon-time"></use></svg></div></small><style data-emotion="css qq1p72">.css-qq1p72{margin-left:10px;margin-right:20px;cursor:pointer;}</style><small class="css-qq1p72"><a href="/archive"><span><time dateTime="2020-10-10T23:17:42.000Z">20-10-10</time></span></a></small></div><div class="css-12qt3ml"><small class="css-2ldgmb"><div class="css-l2tq7e"><svg class="icon css-brme6v" aria-hidden="true"><use xlink:href="#icon-leimupinleifenleileibie2"></use></svg></div></small><small class="css-qq1p72"><a href="/category"><span>前往分类</span></a></small></div><div class="css-12qt3ml"><small class="css-2ldgmb"><div class="css-l2tq7e"><svg class="icon css-brme6v" aria-hidden="true"><use xlink:href="#icon-tag1"></use></svg></div></small><small class="css-qq1p72"><a href="/tag/javascript"><span>javascript<!-- --> </span></a></small></div></div></div><style data-emotion="css h25mx1">.css-h25mx1{border-bottom:1px solid #30a9de;margin-top:20px;margin-bottom:20px;}</style><div class="css-h25mx1"></div><div><p>数组使用 <code>for、forEach、every、some</code>都是通过数组下标遍历属性，ES6 <code>for...of</code>可以直接通过迭代器遍历数组的值。</p>
<p><code>for...of</code> 内部创建一个循环用于遍历可迭代对象（包括:内置的<code>string</code>、<code>array</code>、类数组对象(例如函数参数<code>arguments</code>或节点<code>nodeList</code>)、<code>TypedArray</code>、<code>Map</code>、<code>Set</code>和用户定义的迭代对象）。它调用一个定制的迭代钩子，其中包含针对对象的每个不同属性的值执行的语句</p>
<h3 id="user-content-数组为何可以使用forof遍历"><a href="#%E6%95%B0%E7%BB%84%E4%B8%BA%E4%BD%95%E5%8F%AF%E4%BB%A5%E4%BD%BF%E7%94%A8forof%E9%81%8D%E5%8E%86" aria-hidden="true" tabindex="-1"><span></span></a>数组为何可以使用<code>for...of</code>遍历</h3>
<p>for...of语法适用于遍历定义了迭代器的对象，而数组刚好有内置的<code>@@iterator</code>,因此可以直接应用。</p>
<pre><code><span>var</span> arr = [<span>1</span>, <span>2</span>, <span>3</span>];
<span>var</span> it = arr[<span>Symbol</span>.<span>iterator</span>]()

<span>console</span>.<span>log</span>(it.<span>next</span>()) <span>// {value:1,done:false}</span>
<span>console</span>.<span>log</span>(it.<span>next</span>()) <span>// {value:2,done:false}</span>
<span>console</span>.<span>log</span>(it.<span>next</span>()) <span>// {value:3,done:false}</span>
<span>console</span>.<span>log</span>(it.<span>next</span>()) <span>// {value:undefined,done:true}</span></code></pre>
<p>符号<code>Symbol.iterator</code>获取对象的<code>@@iterator</code>内部属性。引用类似iterator的特殊属性时要使用符号名，而不是符号代表的值。(?) <code>@@iterator</code>其实并不是一个迭代器对象，而是一个返回迭代器对象的函数</p>
<h3 id="user-content-迭代协议iteration-protocols"><a href="#%E8%BF%AD%E4%BB%A3%E5%8D%8F%E8%AE%AEiteration-protocols" aria-hidden="true" tabindex="-1"><span></span></a>迭代协议（Iteration protocols）</h3>
<h3 id="user-content-给普通的对象定义iterator迭代器"><a href="#%E7%BB%99%E6%99%AE%E9%80%9A%E7%9A%84%E5%AF%B9%E8%B1%A1%E5%AE%9A%E4%B9%89iterator%E8%BF%AD%E4%BB%A3%E5%99%A8" aria-hidden="true" tabindex="-1"><span></span></a>给普通的对象定义<code>@@iterator</code>迭代器</h3>
<p>比如一个普通的obj对象，含有a、b两个属性。为该对象定义一个<code>Symbol.iterator</code>迭代器属性，即可使用for-of 遍历</p>
<pre><code><span>var</span> myObject = {
  <span>a</span>: <span>2</span>,
  <span>b</span>: <span>3</span>,
};
<span>Object</span>.<span>defineProperty</span>(myObject, <span>Symbol</span>.<span>iterator</span>, {
  <span>enumerable</span>: <span>true</span>,
  <span>writable</span>: <span>false</span>,
  <span>configurable</span>: <span>true</span>,
  <span>value</span>: <span>function</span> (<span></span>) {
    <span>var</span> o = <span>this</span>;
    <span>var</span> idx = <span>0</span>;
    <span>var</span> ks = <span>Object</span>.<span>keys</span>(o);
    <span>return</span> {
      <span>next</span>: <span>function</span> (<span></span>) {
        <span>return</span> {
          <span>value</span>: o[ks[idx++]],
          <span>done</span>: idx > ks.<span>length</span>,
        };
      },
    };
  },
});</code></pre>
</div></article></main></div><style data-emotion="css 1st94pw">.css-1st94pw{text-align:center;height:30px;line-height:30px;color:#333;}</style><div class="css-1st94pw"><a href="https://beian.miit.gov.cn/" target="_blank" rel="noreferrer">京ICP备19054504号-2</a></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"postData":{"id":"js forof 遍历对象","contentHtml":"\u003cp\u003e数组使用 \u003ccode\u003efor、forEach、every、some\u003c/code\u003e都是通过数组下标遍历属性，ES6 \u003ccode\u003efor...of\u003c/code\u003e可以直接通过迭代器遍历数组的值。\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003efor...of\u003c/code\u003e 内部创建一个循环用于遍历可迭代对象（包括:内置的\u003ccode\u003estring\u003c/code\u003e、\u003ccode\u003earray\u003c/code\u003e、类数组对象(例如函数参数\u003ccode\u003earguments\u003c/code\u003e或节点\u003ccode\u003enodeList\u003c/code\u003e)、\u003ccode\u003eTypedArray\u003c/code\u003e、\u003ccode\u003eMap\u003c/code\u003e、\u003ccode\u003eSet\u003c/code\u003e和用户定义的迭代对象）。它调用一个定制的迭代钩子，其中包含针对对象的每个不同属性的值执行的语句\u003c/p\u003e\n\u003ch3 id=\"user-content-数组为何可以使用forof遍历\"\u003e\u003ca href=\"#%E6%95%B0%E7%BB%84%E4%B8%BA%E4%BD%95%E5%8F%AF%E4%BB%A5%E4%BD%BF%E7%94%A8forof%E9%81%8D%E5%8E%86\" aria-hidden=\"true\" tabindex=\"-1\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/a\u003e数组为何可以使用\u003ccode\u003efor...of\u003c/code\u003e遍历\u003c/h3\u003e\n\u003cp\u003efor...of语法适用于遍历定义了迭代器的对象，而数组刚好有内置的\u003ccode\u003e@@iterator\u003c/code\u003e,因此可以直接应用。\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e\u003cspan\u003evar\u003c/span\u003e arr = [\u003cspan\u003e1\u003c/span\u003e, \u003cspan\u003e2\u003c/span\u003e, \u003cspan\u003e3\u003c/span\u003e];\n\u003cspan\u003evar\u003c/span\u003e it = arr[\u003cspan\u003eSymbol\u003c/span\u003e.\u003cspan\u003eiterator\u003c/span\u003e]()\n\n\u003cspan\u003econsole\u003c/span\u003e.\u003cspan\u003elog\u003c/span\u003e(it.\u003cspan\u003enext\u003c/span\u003e()) \u003cspan\u003e// {value:1,done:false}\u003c/span\u003e\n\u003cspan\u003econsole\u003c/span\u003e.\u003cspan\u003elog\u003c/span\u003e(it.\u003cspan\u003enext\u003c/span\u003e()) \u003cspan\u003e// {value:2,done:false}\u003c/span\u003e\n\u003cspan\u003econsole\u003c/span\u003e.\u003cspan\u003elog\u003c/span\u003e(it.\u003cspan\u003enext\u003c/span\u003e()) \u003cspan\u003e// {value:3,done:false}\u003c/span\u003e\n\u003cspan\u003econsole\u003c/span\u003e.\u003cspan\u003elog\u003c/span\u003e(it.\u003cspan\u003enext\u003c/span\u003e()) \u003cspan\u003e// {value:undefined,done:true}\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e符号\u003ccode\u003eSymbol.iterator\u003c/code\u003e获取对象的\u003ccode\u003e@@iterator\u003c/code\u003e内部属性。引用类似iterator的特殊属性时要使用符号名，而不是符号代表的值。(?) \u003ccode\u003e@@iterator\u003c/code\u003e其实并不是一个迭代器对象，而是一个返回迭代器对象的函数\u003c/p\u003e\n\u003ch3 id=\"user-content-迭代协议iteration-protocols\"\u003e\u003ca href=\"#%E8%BF%AD%E4%BB%A3%E5%8D%8F%E8%AE%AEiteration-protocols\" aria-hidden=\"true\" tabindex=\"-1\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/a\u003e迭代协议（Iteration protocols）\u003c/h3\u003e\n\u003ch3 id=\"user-content-给普通的对象定义iterator迭代器\"\u003e\u003ca href=\"#%E7%BB%99%E6%99%AE%E9%80%9A%E7%9A%84%E5%AF%B9%E8%B1%A1%E5%AE%9A%E4%B9%89iterator%E8%BF%AD%E4%BB%A3%E5%99%A8\" aria-hidden=\"true\" tabindex=\"-1\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/a\u003e给普通的对象定义\u003ccode\u003e@@iterator\u003c/code\u003e迭代器\u003c/h3\u003e\n\u003cp\u003e比如一个普通的obj对象，含有a、b两个属性。为该对象定义一个\u003ccode\u003eSymbol.iterator\u003c/code\u003e迭代器属性，即可使用for-of 遍历\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e\u003cspan\u003evar\u003c/span\u003e myObject = {\n  \u003cspan\u003ea\u003c/span\u003e: \u003cspan\u003e2\u003c/span\u003e,\n  \u003cspan\u003eb\u003c/span\u003e: \u003cspan\u003e3\u003c/span\u003e,\n};\n\u003cspan\u003eObject\u003c/span\u003e.\u003cspan\u003edefineProperty\u003c/span\u003e(myObject, \u003cspan\u003eSymbol\u003c/span\u003e.\u003cspan\u003eiterator\u003c/span\u003e, {\n  \u003cspan\u003eenumerable\u003c/span\u003e: \u003cspan\u003etrue\u003c/span\u003e,\n  \u003cspan\u003ewritable\u003c/span\u003e: \u003cspan\u003efalse\u003c/span\u003e,\n  \u003cspan\u003econfigurable\u003c/span\u003e: \u003cspan\u003etrue\u003c/span\u003e,\n  \u003cspan\u003evalue\u003c/span\u003e: \u003cspan\u003efunction\u003c/span\u003e (\u003cspan\u003e\u003c/span\u003e) {\n    \u003cspan\u003evar\u003c/span\u003e o = \u003cspan\u003ethis\u003c/span\u003e;\n    \u003cspan\u003evar\u003c/span\u003e idx = \u003cspan\u003e0\u003c/span\u003e;\n    \u003cspan\u003evar\u003c/span\u003e ks = \u003cspan\u003eObject\u003c/span\u003e.\u003cspan\u003ekeys\u003c/span\u003e(o);\n    \u003cspan\u003ereturn\u003c/span\u003e {\n      \u003cspan\u003enext\u003c/span\u003e: \u003cspan\u003efunction\u003c/span\u003e (\u003cspan\u003e\u003c/span\u003e) {\n        \u003cspan\u003ereturn\u003c/span\u003e {\n          \u003cspan\u003evalue\u003c/span\u003e: o[ks[idx++]],\n          \u003cspan\u003edone\u003c/span\u003e: idx \u003e ks.\u003cspan\u003elength\u003c/span\u003e,\n        };\n      },\n    };\n  },\n});\u003c/code\u003e\u003c/pre\u003e\n","title":"JS forof 遍历数组的原理","date":"2020-10-10T23:17:42.000Z","description":"阐述 forof 遍历数组的原理，并由此介绍 ES6 引入的迭代协议","tag":"javascript"}},"__N_SSG":true},"page":"/posts/[id]","query":{"id":"js forof 遍历对象"},"buildId":"yk5Zpotj4p9R4XPv5qhw8","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>