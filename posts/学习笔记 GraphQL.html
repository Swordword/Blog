<!DOCTYPE html><html lang="zh-Hans"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><link rel="icon" href="/favicon.ico"/><meta name="description" content="Learn how to build a personal website using Next.js"/><meta property="og:image" content="https://og-image.now.sh/Swordword&#x27;s%20blog.png?theme=light&amp;md=0&amp;fontSize=75px&amp;images=https%3A%2F%2Fassets.vercel.com%2Fimage%2Fupload%2Ffront%2Fassets%2Fdesign%2Fnextjs-black-logo.svg"/><meta name="og:title" content="Swordword&#x27;s blog"/><title>GraphQl探秘</title><meta name="next-head-count" content="7"/><link rel="preload" href="/_next/static/css/876d048b5dab7c28.css" as="style"/><link rel="stylesheet" href="/_next/static/css/876d048b5dab7c28.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-a03f34702f60fafc.js" defer=""></script><script src="/_next/static/chunks/framework-2c79e2a64abdb08b.js" defer=""></script><script src="/_next/static/chunks/main-7c48f75ce2db1491.js" defer=""></script><script src="/_next/static/chunks/pages/_app-e272e05dd28ef959.js" defer=""></script><script src="/_next/static/chunks/130-b952c5d507d712ac.js" defer=""></script><script src="/_next/static/chunks/749-555cb8054e68346e.js" defer=""></script><script src="/_next/static/chunks/241-e8e3e8578555aa77.js" defer=""></script><script src="/_next/static/chunks/783-464c81cbfd42177e.js" defer=""></script><script src="/_next/static/chunks/pages/posts/%5Bid%5D-4108770bd2d21ccc.js" defer=""></script><script src="/_next/static/yk5Zpotj4p9R4XPv5qhw8/_buildManifest.js" defer=""></script><script src="/_next/static/yk5Zpotj4p9R4XPv5qhw8/_ssgManifest.js" defer=""></script></head><body><div id="__next"><style data-emotion="css dbbey5">.css-dbbey5{width:100vw;height:100vh;overflow-y:scroll;background:#eee;color:#3c4858;padding-bottom:50px;}</style><div class="css-dbbey5"><style data-emotion="css gpj3uu">.css-gpj3uu{width:100%;height:50px;color:#fff;background-color:rgba(47,65,84,0.7);box-shadow:0 2px 5px 0 rgb(0 0 0 / 16%),0 2px 10px 0 rgb(0 0 0 / 12%);position:fixed;top:0;left:0;z-index:2;}</style><div class="css-gpj3uu"><style data-emotion="css qjodyr">.css-qjodyr{width:1100px;height:100%;margin:auto;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}</style><div class="css-qjodyr"><a href="/"><style data-emotion="css 19m5m0c">.css-19m5m0c{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:start;-ms-flex-pack:start;-webkit-justify-content:flex-start;justify-content:flex-start;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;cursor:pointer;}</style><div class="css-19m5m0c"><style data-emotion="css l2tq7e">.css-l2tq7e{width:30px;height:30px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}</style><div class="css-l2tq7e"><style data-emotion="css brme6v">.css-brme6v{width:24px;height:24px;margin-left:6px;}</style><svg class="icon css-brme6v" aria-hidden="true"><use xlink:href="#icon-sword"></use></svg></div><style data-emotion="css 879ic9">.css-879ic9{margin-left:20px;}</style><div class="css-879ic9">Swordword</div></div></a><style data-emotion="css fhxb3m">.css-fhxb3m{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}</style><div class="css-fhxb3m"><a href="/"><style data-emotion="css kfc5ms">.css-kfc5ms{width:100px;height:50px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;cursor:pointer;}.css-kfc5ms:hover{color:#30A9DE;background-color:rgba(0,0,0,0.1);}</style><div class="css-kfc5ms"><div class="css-l2tq7e"><svg class="icon css-brme6v" aria-hidden="true"><use xlink:href="#icon-home"></use></svg></div><style data-emotion="css 1a2afmv">.css-1a2afmv{margin-left:10px;}</style><div class="css-1a2afmv">首页</div></div></a><style data-emotion="css 1lwiia1">.css-1lwiia1{width:100px;height:50px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;cursor:pointer;position:relative;}.css-1lwiia1:hover .nav-list{display:block;}</style><div class="css-1lwiia1"><div class="css-l2tq7e"><svg class="icon css-brme6v" aria-hidden="true"><use xlink:href="#icon-list"></use></svg></div><div class="css-1a2afmv">索引</div><style data-emotion="css su4vv2">.css-su4vv2{-webkit-transition:3s ease-out;transition:3s ease-out;display:none;width:100px;position:absolute;top:50px;left:0;background-color:rgba(47,65,84,0.7);box-shadow:0 2px 5px 0 rgb(0 0 0 / 16%),0 2px 10px 0 rgb(0 0 0 / 12%);}</style><div class="nav-list css-su4vv2"><a href="/archive"><div class="css-kfc5ms"><div class="css-l2tq7e"><svg class="icon css-brme6v" aria-hidden="true"><use xlink:href="#icon-guidang"></use></svg></div><div class="css-1a2afmv">归档</div></div></a><a href="/category"><div class="css-kfc5ms"><div class="css-l2tq7e"><svg class="icon css-brme6v" aria-hidden="true"><use xlink:href="#icon-leimupinleifenleileibie2"></use></svg></div><div class="css-1a2afmv">分类</div></div></a><a href="/tag"><div class="css-kfc5ms"><div class="css-l2tq7e"><svg class="icon css-brme6v" aria-hidden="true"><use xlink:href="#icon-tag1"></use></svg></div><div class="css-1a2afmv">标签</div></div></a></div></div><a href="/about"><div class="css-kfc5ms"><div class="css-l2tq7e"><svg class="icon css-brme6v" aria-hidden="true"><use xlink:href="#icon-lianhe4"></use></svg></div><div class="css-1a2afmv">关于</div></div></a><a href="/rss"><div class="css-kfc5ms"><div class="css-l2tq7e"><svg class="icon css-brme6v" aria-hidden="true"><use xlink:href="#icon-rss"></use></svg></div><div class="css-1a2afmv">RSS</div></div></a><div class="css-l2tq7e"><svg class="icon css-brme6v" aria-hidden="true"><use xlink:href="#icon-OOjs_UI_icon_search-ltr"></use></svg></div><div class="css-1a2afmv"><div class="css-l2tq7e"><svg class="icon css-brme6v" aria-hidden="true"><use xlink:href="#icon-sun"></use></svg></div></div></div></div></div><style data-emotion="css 1739oy8">.css-1739oy8{z-index:1;}</style><div class="css-1739oy8"><style data-emotion="css z6d19t">.css-z6d19t{width:100%;height:350px;position:relative;background:url(/_next/static/media/banner.eb35a883.jpg) center;}</style><div class="css-z6d19t"></div></div><style data-emotion="css 3vwp2t">.css-3vwp2t{position:relative;width:1100px;background:#fff;padding:50px 100px;margin:-150px auto 50px;border-radius:8px;}</style><main class="css-3vwp2t"><article style="color:#3c4858"><style data-emotion="css yrjjfw">.css-yrjjfw{height:70px;margin:0;line-height:70px;text-align:center;font-size:40px;}</style><h1 class="css-yrjjfw">GraphQl探秘</h1><style data-emotion="css faxeo3">.css-faxeo3{margin-left:250px;}</style><div class="css-faxeo3"><style data-emotion="css hc4w4d">.css-hc4w4d{height:40px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:start;-ms-flex-pack:start;-webkit-justify-content:flex-start;justify-content:flex-start;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}</style><div class="css-hc4w4d"><style data-emotion="css 12qt3ml">.css-12qt3ml{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:start;-ms-flex-pack:start;-webkit-justify-content:flex-start;justify-content:flex-start;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}</style><div class="css-12qt3ml"><style data-emotion="css 2ldgmb">.css-2ldgmb{color:#30a9de;}</style><small class="css-2ldgmb"><div class="css-l2tq7e"><svg class="icon css-brme6v" aria-hidden="true"><use xlink:href="#icon-time"></use></svg></div></small><style data-emotion="css qq1p72">.css-qq1p72{margin-left:10px;margin-right:20px;cursor:pointer;}</style><small class="css-qq1p72"><a href="/archive"><span><time dateTime="2022-01-10T23:46:37.000Z">22-01-10</time></span></a></small></div><div class="css-12qt3ml"><small class="css-2ldgmb"><div class="css-l2tq7e"><svg class="icon css-brme6v" aria-hidden="true"><use xlink:href="#icon-leimupinleifenleileibie2"></use></svg></div></small><small class="css-qq1p72"><a href="/category/category"><span>category</span></a></small></div><div class="css-12qt3ml"><small class="css-2ldgmb"><div class="css-l2tq7e"><svg class="icon css-brme6v" aria-hidden="true"><use xlink:href="#icon-tag1"></use></svg></div></small><small class="css-qq1p72"><a href="/tag/sql"><span>sql<!-- --> </span></a><a href="/tag"><span> </span></a></small></div></div></div><style data-emotion="css h25mx1">.css-h25mx1{border-bottom:1px solid #30a9de;margin-top:20px;margin-bottom:20px;}</style><div class="css-h25mx1"></div><div><p>操作类型 Operation Type：</p>
<ul>
<li>query 查询：</li>
<li>mutation 变更：</li>
<li>substription 订阅：</li>
</ul>
<p>对象类型与标量类型</p>
<p>GraphQL 查询会同等看待单个项目或者一个列表的项目,查询一个字段结果有可能是一项或者一个数组</p>
<h4 id="user-content-查询与变更"><a href="#%E6%9F%A5%E8%AF%A2%E4%B8%8E%E5%8F%98%E6%9B%B4" aria-hidden="true" tabindex="-1"><span></span></a>查询与变更</h4>
<p>约定变更服务端数据通过 <code>mutation</code>语句表示</p>
<pre><code><span>mutation</span> CreateReviewForEpisode<span>(</span><span>$ep</span>: Episode<span>!</span>, <span>$review</span>: ReviewInput<span>!</span><span>)</span> <span>{</span>
  createReview<span>(</span><span>episode</span><span>:</span> <span>$ep</span>, <span>review</span><span>:</span> <span>$review</span>) <span>{</span>
    stars
    commentary
  <span>}</span>
<span>}</span>
<span>{</span>
  <span>"ep"</span><span>:</span> <span>"JEDI"</span>,
  <span>"review"</span><span>:</span> <span>{</span>
    <span>"stars"</span><span>:</span> <span>5</span>,
    <span>"commentary"</span><span>:</span> <span>"This is a great movie!"</span>
  <span>}</span>
<span>}</span></code></pre>
<p><strong>查询字段时，是并行执行，而变更字段时，是线性执行，一个接着一个。</strong></p>
<h4 id="user-content-内联片段-inline-fragments"><a href="#%E5%86%85%E8%81%94%E7%89%87%E6%AE%B5-inline-fragments" aria-hidden="true" tabindex="-1"><span></span></a>内联片段 Inline Fragments</h4>
<p>如果查询的子弹返回的是接口或者联合类型，需要使用<strong>内联片段</strong>取出下层具体类型的数据</p>
<pre><code>query HeroForEpisode($ep: Episode!) {
  hero(episode: $ep) {
    name
    ... on Droid {
      primaryFunction
    }
    ... on Human {
      height
    }
  }
}
{
  "ep": "JEDI"
}
</code></pre>
<p>返回的hero 只有是Droid类型时会有promaryFunction字段，只有是Human字段时会有height字段</p>
<h4 id="user-content-元字段-meta-fields"><a href="#%E5%85%83%E5%AD%97%E6%AE%B5-meta-fields" aria-hidden="true" tabindex="-1"><span></span></a>元字段 Meta fields</h4>
<p>元字段中的 __typename可以放置在查询的任何位置上，获取该位置对象的类型名称</p>
<pre><code>{
  search(text: "an") {
    __typename
    ... on Human {
      name
    }
    ... on Droid {
      name
    }
    ... on Starship {
      name
    }
  }
}
# res:
{
  "data": {
    "search": [
      {
        "__typename": "Human",
        "name": "Han Solo"
      },
      {
        "__typename": "Human",
        "name": "Leia Organa"
      },
      {
        "__typename": "Starship",
        "name": "TIE Advanced x1"
      }
    ]
  }
}
</code></pre>
<h3 id="user-content-schema-与类型"><a href="#schema-%E4%B8%8E%E7%B1%BB%E5%9E%8B" aria-hidden="true" tabindex="-1"><span></span></a>Schema 与类型</h3>
<h4 id="user-content-对象类型与字段"><a href="#%E5%AF%B9%E8%B1%A1%E7%B1%BB%E5%9E%8B%E4%B8%8E%E5%AD%97%E6%AE%B5" aria-hidden="true" tabindex="-1"><span></span></a>对象类型与字段</h4>
<pre><code><span>type</span> Character <span>{</span>
  <span>name</span><span>:</span> String<span>!</span>
  <span>appearsIn</span><span>:</span> <span>[</span>Episode<span>!</span><span>]</span><span>!</span>
<span>}</span></code></pre>
<p>Character 是 GraphQL对象类型，</p>
<p>[未完待续...]</p>
</div></article></main></div><style data-emotion="css 1st94pw">.css-1st94pw{text-align:center;height:30px;line-height:30px;color:#333;}</style><div class="css-1st94pw"><a href="https://beian.miit.gov.cn/" target="_blank" rel="noreferrer">京ICP备19054504号-2</a></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"postData":{"id":"学习笔记 GraphQL","contentHtml":"\u003cp\u003e操作类型 Operation Type：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003equery 查询：\u003c/li\u003e\n\u003cli\u003emutation 变更：\u003c/li\u003e\n\u003cli\u003esubstription 订阅：\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e对象类型与标量类型\u003c/p\u003e\n\u003cp\u003eGraphQL 查询会同等看待单个项目或者一个列表的项目,查询一个字段结果有可能是一项或者一个数组\u003c/p\u003e\n\u003ch4 id=\"user-content-查询与变更\"\u003e\u003ca href=\"#%E6%9F%A5%E8%AF%A2%E4%B8%8E%E5%8F%98%E6%9B%B4\" aria-hidden=\"true\" tabindex=\"-1\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/a\u003e查询与变更\u003c/h4\u003e\n\u003cp\u003e约定变更服务端数据通过 \u003ccode\u003emutation\u003c/code\u003e语句表示\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e\u003cspan\u003emutation\u003c/span\u003e CreateReviewForEpisode\u003cspan\u003e(\u003c/span\u003e\u003cspan\u003e$ep\u003c/span\u003e: Episode\u003cspan\u003e!\u003c/span\u003e, \u003cspan\u003e$review\u003c/span\u003e: ReviewInput\u003cspan\u003e!\u003c/span\u003e\u003cspan\u003e)\u003c/span\u003e \u003cspan\u003e{\u003c/span\u003e\n  createReview\u003cspan\u003e(\u003c/span\u003e\u003cspan\u003eepisode\u003c/span\u003e\u003cspan\u003e:\u003c/span\u003e \u003cspan\u003e$ep\u003c/span\u003e, \u003cspan\u003ereview\u003c/span\u003e\u003cspan\u003e:\u003c/span\u003e \u003cspan\u003e$review\u003c/span\u003e) \u003cspan\u003e{\u003c/span\u003e\n    stars\n    commentary\n  \u003cspan\u003e}\u003c/span\u003e\n\u003cspan\u003e}\u003c/span\u003e\n\u003cspan\u003e{\u003c/span\u003e\n  \u003cspan\u003e\"ep\"\u003c/span\u003e\u003cspan\u003e:\u003c/span\u003e \u003cspan\u003e\"JEDI\"\u003c/span\u003e,\n  \u003cspan\u003e\"review\"\u003c/span\u003e\u003cspan\u003e:\u003c/span\u003e \u003cspan\u003e{\u003c/span\u003e\n    \u003cspan\u003e\"stars\"\u003c/span\u003e\u003cspan\u003e:\u003c/span\u003e \u003cspan\u003e5\u003c/span\u003e,\n    \u003cspan\u003e\"commentary\"\u003c/span\u003e\u003cspan\u003e:\u003c/span\u003e \u003cspan\u003e\"This is a great movie!\"\u003c/span\u003e\n  \u003cspan\u003e}\u003c/span\u003e\n\u003cspan\u003e}\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cstrong\u003e查询字段时，是并行执行，而变更字段时，是线性执行，一个接着一个。\u003c/strong\u003e\u003c/p\u003e\n\u003ch4 id=\"user-content-内联片段-inline-fragments\"\u003e\u003ca href=\"#%E5%86%85%E8%81%94%E7%89%87%E6%AE%B5-inline-fragments\" aria-hidden=\"true\" tabindex=\"-1\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/a\u003e内联片段 Inline Fragments\u003c/h4\u003e\n\u003cp\u003e如果查询的子弹返回的是接口或者联合类型，需要使用\u003cstrong\u003e内联片段\u003c/strong\u003e取出下层具体类型的数据\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003equery HeroForEpisode($ep: Episode!) {\n  hero(episode: $ep) {\n    name\n    ... on Droid {\n      primaryFunction\n    }\n    ... on Human {\n      height\n    }\n  }\n}\n{\n  \"ep\": \"JEDI\"\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e返回的hero 只有是Droid类型时会有promaryFunction字段，只有是Human字段时会有height字段\u003c/p\u003e\n\u003ch4 id=\"user-content-元字段-meta-fields\"\u003e\u003ca href=\"#%E5%85%83%E5%AD%97%E6%AE%B5-meta-fields\" aria-hidden=\"true\" tabindex=\"-1\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/a\u003e元字段 Meta fields\u003c/h4\u003e\n\u003cp\u003e元字段中的 __typename可以放置在查询的任何位置上，获取该位置对象的类型名称\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e{\n  search(text: \"an\") {\n    __typename\n    ... on Human {\n      name\n    }\n    ... on Droid {\n      name\n    }\n    ... on Starship {\n      name\n    }\n  }\n}\n# res:\n{\n  \"data\": {\n    \"search\": [\n      {\n        \"__typename\": \"Human\",\n        \"name\": \"Han Solo\"\n      },\n      {\n        \"__typename\": \"Human\",\n        \"name\": \"Leia Organa\"\n      },\n      {\n        \"__typename\": \"Starship\",\n        \"name\": \"TIE Advanced x1\"\n      }\n    ]\n  }\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"user-content-schema-与类型\"\u003e\u003ca href=\"#schema-%E4%B8%8E%E7%B1%BB%E5%9E%8B\" aria-hidden=\"true\" tabindex=\"-1\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/a\u003eSchema 与类型\u003c/h3\u003e\n\u003ch4 id=\"user-content-对象类型与字段\"\u003e\u003ca href=\"#%E5%AF%B9%E8%B1%A1%E7%B1%BB%E5%9E%8B%E4%B8%8E%E5%AD%97%E6%AE%B5\" aria-hidden=\"true\" tabindex=\"-1\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/a\u003e对象类型与字段\u003c/h4\u003e\n\u003cpre\u003e\u003ccode\u003e\u003cspan\u003etype\u003c/span\u003e Character \u003cspan\u003e{\u003c/span\u003e\n  \u003cspan\u003ename\u003c/span\u003e\u003cspan\u003e:\u003c/span\u003e String\u003cspan\u003e!\u003c/span\u003e\n  \u003cspan\u003eappearsIn\u003c/span\u003e\u003cspan\u003e:\u003c/span\u003e \u003cspan\u003e[\u003c/span\u003eEpisode\u003cspan\u003e!\u003c/span\u003e\u003cspan\u003e]\u003c/span\u003e\u003cspan\u003e!\u003c/span\u003e\n\u003cspan\u003e}\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eCharacter 是 GraphQL对象类型，\u003c/p\u003e\n\u003cp\u003e[未完待续...]\u003c/p\u003e\n","title":"GraphQl探秘","date":"2022-01-10T23:46:37.000Z","category":"category","tag":"sql,","cover":null,"description":"Facebook 推出的新一代查询接口"}},"__N_SSG":true},"page":"/posts/[id]","query":{"id":"学习笔记 GraphQL"},"buildId":"yk5Zpotj4p9R4XPv5qhw8","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>