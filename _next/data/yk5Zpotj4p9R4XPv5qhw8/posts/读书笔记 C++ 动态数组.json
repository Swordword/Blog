{"pageProps":{"postData":{"id":"读书笔记 C++ 动态数组","contentHtml":"<p>普通的<code>new</code>和<code>delete</code>一次只能分配和释放一个对象，但是如果想要一次性分配含有10个元素的数组该怎么办呢？就得 <code>new</code> 10次嘛？那如果需要一次性分配10000个数组的内存呢？就需要动态数组来搞定了。</p>\n<h3 id=\"user-content-new-和数组\"><a href=\"#new-%E5%92%8C%E6%95%B0%E7%BB%84\" aria-hidden=\"true\" tabindex=\"-1\"><span></span></a>new 和数组</h3>\n<p>可以通过在类型名之后添加一个方括号，并在其中指定要分配的对象的数目。</p>\n<pre><code>\t<span>int</span> *pia = <span>new</span> <span>int</span>[<span>42</span>];</code></pre>\n<p>也可以使用类型别名，这样可能更加直观一点</p>\n<pre><code>\t<span>typedef</span> <span>int</span> arrT[<span>42</span>];\n\t<span>int</span> *p = <span>new</span> arrT;\n\t<span>using</span> arrT = <span>int</span>[<span>42</span>];\n\t<span>int</span> *q = <span>new</span> arrT;</code></pre>\n<p>甚至可以使用一个返回正整形的函数作为对象数目的参数</p>\n<pre><code><span>int</span> * ptr = <span>new</span> <span>int</span>[<span>getSize</span>()];</code></pre>\n<p><strong>这个函数返回值必须是个整数，但不必是个常量</strong></p>\n<h4 id=\"user-content-动态数组返回指向第一个对象的指针而不是一个数组类型的对象\"><a href=\"#%E5%8A%A8%E6%80%81%E6%95%B0%E7%BB%84%E8%BF%94%E5%9B%9E%E6%8C%87%E5%90%91%E7%AC%AC%E4%B8%80%E4%B8%AA%E5%AF%B9%E8%B1%A1%E7%9A%84%E6%8C%87%E9%92%88%E8%80%8C%E4%B8%8D%E6%98%AF%E4%B8%80%E4%B8%AA%E6%95%B0%E7%BB%84%E7%B1%BB%E5%9E%8B%E7%9A%84%E5%AF%B9%E8%B1%A1\" aria-hidden=\"true\" tabindex=\"-1\"><span></span></a>动态数组返回指向第一个对象的指针而不是一个数组类型的对象</h4>\n<p>与普通数组不同，比如像<code>int num[5]={0,1,2,3,4};</code>虽然 <code>num</code>很多情况下单独使用时也会被编译器替换为指向数组首元素的指针，但是其本身还是数组类型（一种类似引用和指针的复合类型），而上例的<code>pia</code>本身就是一个指针，因此不能使用<code>begin</code>和<code>end</code>标准库函数</p>\n<h4 id=\"user-content-初始化动态分配对象的数组\"><a href=\"#%E5%88%9D%E5%A7%8B%E5%8C%96%E5%8A%A8%E6%80%81%E5%88%86%E9%85%8D%E5%AF%B9%E8%B1%A1%E7%9A%84%E6%95%B0%E7%BB%84\" aria-hidden=\"true\" tabindex=\"-1\"><span></span></a>初始化动态分配对象的数组</h4>\n<p>默认情况下，<code>new</code>分配的对象都是默认初始化的，也可以通过在其大小之后跟一对()进行值初始化</p>\n<pre><code><span>// 默认初始化</span>\n<span>int</span> * pia = <span>new</span> <span>int</span>[<span>10</span>];\t<span>// 10个未定义的 int</span>\n<span>int</span> * psa = <span>new</span> string[<span>10</span>];\n<span>// 值初始化</span>\n<span>int</span> * pia2 = <span>new</span> <span>int</span>[<span>10</span>]();\t\t<span>// 10个初始值为0 int</span>\n<span>int</span> * psa = <span>new</span> string[<span>10</span>]();\n<span>// C++11 使用元素初始化器进行初始化</span>\n<span>int</span> *pia3 = <span>new</span> <span>int</span>[<span>10</span>]{<span>0</span>,<span>1</span>,<span>2</span>,<span>3</span>};\n</code></pre>\n<h4 id=\"user-content-动态数组对象数目可以动态分配\"><a href=\"#%E5%8A%A8%E6%80%81%E6%95%B0%E7%BB%84%E5%AF%B9%E8%B1%A1%E6%95%B0%E7%9B%AE%E5%8F%AF%E4%BB%A5%E5%8A%A8%E6%80%81%E5%88%86%E9%85%8D\" aria-hidden=\"true\" tabindex=\"-1\"><span></span></a>动态数组对象数目可以动态分配</h4>\n<pre><code><span>size_t</span> n = <span>get_size</span>();\n<span>int</span> * p = <span>new</span> <span>int</span>[n];\n<span>for</span>(<span>int</span> *q = p; q != p+n; ++q){...}</code></pre>\n<p>当n为0时，返回一个合法的非空指针。（<code>int arr[0]</code> 报错：不能定义长度为0的数组）</p>\n<h4 id=\"user-content-\"></h4>\n<p>[未完待续...]</p>\n","title":"读书笔记 C++ 动态数组","date":"2021-04-07T22:04:35.000Z","description":"description","tag":"C++"}},"__N_SSG":true}